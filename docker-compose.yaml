services:
  bot:
    build:
      context: ./bot
      target: development
    port: 6379:6379
    volumes:
      - ./bot:/kevin/bot
      - ./db:/db
      - ./log/bot:/log
  redis:
    build:
      context: ./bot
      target: redisJSON
    entrypoint: sleep 100000000
  rules:
    build:
      context: .
      dockerfile: ./rules.Dockerfile
    volumes:
      - ./log/rules:/log
    command: 
      - /wait-for-it.sh
      - bot:8080
      - --
      - /run_rules.sh